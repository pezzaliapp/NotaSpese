<!DOCTYPE html>
 <html lang="it">
 <head>
   <meta charset="UTF-8" />
   <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
   <title>Nota Spese Trasferta</title>
 
   <!-- Collegamento a style.css -->
   <link rel="stylesheet" href="style.css" />
 
   <!-- Manifest PWA -->
   <link rel="manifest" href="manifest.json" />
 </head>
 <body>
 
   <header>
     <h1>Nota Spese Trasferta</h1>
   </header>
 
   <!-- DATI GENERALI -->
   <section>
     <div class="riga-dati">
       <label for="dipendente">Dipendente:</label>
       <input type="text" id="dipendente" placeholder="Nome Dipendente" />
 
       <label for="targa">Targa Automezzo:</label>
       <input type="text" id="targa" placeholder="Targa Automezzo" />
     </div>
     <div class="riga-dati">
       <label for="num-settimana">N. Settimana:</label>
       <input type="number" id="num-settimana" min="1" max="52" />
 
       <label for="anno">Anno:</label>
       <input type="number" id="anno" placeholder="Anno" />
     </div>
     <div class="riga-dati">
       <button id="carica-settimana">Carica Settimana</button>
       <button id="salva-settimana">Salva Settimana</button>
     </div>
   </section>
 
   <!-- TABELLA PRINCIPALE -->
   <section>
     <div class="table-container">
       <table id="table-spese">
         <thead>
           <!-- RIGA DATE (popolata in automatico da app.js) -->
           <tr id="date-row">
             <th></th>
             <th>--</th>
             <th>--</th>
             <th>--</th>
             <th>--</th>
             <th>--</th>
             <th>--</th>
             <th>--</th>
             <th></th>
           </tr>
           <!-- RIGA LUOGO (input per il luogo di ogni giorno) -->
           <tr id="luogo-row">
             <th></th>
             <th><input type="text" placeholder="Luogo" class="luogo-input" data-day="lun"/></th>
             <th><input type="text" placeholder="Luogo" class="luogo-input" data-day="mar"/></th>
             <th><input type="text" placeholder="Luogo" class="luogo-input" data-day="mer"/></th>
             <th><input type="text" placeholder="Luogo" class="luogo-input" data-day="gio"/></th>
             <th><input type="text" placeholder="Luogo" class="luogo-input" data-day="ven"/></th>
             <th><input type="text" placeholder="Luogo" class="luogo-input" data-day="sab"/></th>
             <th><input type="text" placeholder="Luogo" class="luogo-input" data-day="dom"/></th>
             <th></th>
           </tr>
           <!-- RIGA GIORNI -->
           <tr id="days-row">
             <th>Categoria / Sottocategoria</th>
             <th>Lunedì</th>
             <th>Martedì</th>
             <th>Mercoledì</th>
             <th>Giovedì</th>
             <th>Venerdì</th>
             <th>Sabato</th>
             <th>Domenica</th>
             <th>Totale</th>
           </tr>
         </thead>
         <tbody>
           <!-- KM -->
           <tr>
             <td>Km Iniziali</td>
             <td contenteditable="true" data-cat="kmIni" data-day="lun"></td>
             <td contenteditable="true" data-cat="kmIni" data-day="mar"></td>
             <td contenteditable="true" data-cat="kmIni" data-day="mer"></td>
             <td contenteditable="true" data-cat="kmIni" data-day="gio"></td>
             <td contenteditable="true" data-cat="kmIni" data-day="ven"></td>
             <td contenteditable="true" data-cat="kmIni" data-day="sab"></td>
             <td contenteditable="true" data-cat="kmIni" data-day="dom"></td>
            <td></td>  <!-- Nessuna classe "totale-riga" -->
           </tr>
           <tr>
             <td>Km Finali</td>
             <td contenteditable="true" data-cat="kmFin" data-day="lun"></td>
             <td contenteditable="true" data-cat="kmFin" data-day="mar"></td>
             <td contenteditable="true" data-cat="kmFin" data-day="mer"></td>
             <td contenteditable="true" data-cat="kmFin" data-day="gio"></td>
             <td contenteditable="true" data-cat="kmFin" data-day="ven"></td>
             <td contenteditable="true" data-cat="kmFin" data-day="sab"></td>
             <td contenteditable="true" data-cat="kmFin" data-day="dom"></td>
             <td></td>  <!-- Nessuna classe "totale-riga" -->
           </tr>
           <tr>
             <td>Km giornalieri</td>
             <td data-cat="kmDiff" data-day="lun"></td>
             <td data-cat="kmDiff" data-day="mar"></td>
             <td data-cat="kmDiff" data-day="mer"></td>
             <td data-cat="kmDiff" data-day="gio"></td>
             <td data-cat="kmDiff" data-day="ven"></td>
             <td data-cat="kmDiff" data-day="sab"></td>
             <td data-cat="kmDiff" data-day="dom"></td>
             <td class="totale-riga">0</td>
           </tr>
           <!-- Totale Km Settimana (con classe "totale-riga") -->
           <tr class="totale-riga">
             <td><strong>Totale Km Settimana</strong></td>
             <td colspan="7"></td>
             <td class="km-sett-tot">0</td>
           </tr>
 
           <!-- SPESE VIAGGIO -->
           <tr>
             <td>Parcheggi</td>
             <td contenteditable="true" data-cat="parcheggi" data-day="lun"></td>
             <td contenteditable="true" data-cat="parcheggi" data-day="mar"></td>
             <td contenteditable="true" data-cat="parcheggi" data-day="mer"></td>
             <td contenteditable="true" data-cat="parcheggi" data-day="gio"></td>
             <td contenteditable="true" data-cat="parcheggi" data-day="ven"></td>
             <td contenteditable="true" data-cat="parcheggi" data-day="sab"></td>
             <td contenteditable="true" data-cat="parcheggi" data-day="dom"></td>
             <td class="totale-riga">0</td>
           </tr>
           <tr>
             <td>Noleggio Auto</td>
             <td contenteditable="true" data-cat="noleggio" data-day="lun"></td>
             <td contenteditable="true" data-cat="noleggio" data-day="mar"></td>
             <td contenteditable="true" data-cat="noleggio" data-day="mer"></td>
             <td contenteditable="true" data-cat="noleggio" data-day="gio"></td>
             <td contenteditable="true" data-cat="noleggio" data-day="ven"></td>
             <td contenteditable="true" data-cat="noleggio" data-day="sab"></td>
             <td contenteditable="true" data-cat="noleggio" data-day="dom"></td>
             <td class="totale-riga">0</td>
           </tr>
           <tr>
             <td>Taxi / Autobus</td>
             <td contenteditable="true" data-cat="taxiBus" data-day="lun"></td>
             <td contenteditable="true" data-cat="taxiBus" data-day="mar"></td>
             <td contenteditable="true" data-cat="taxiBus" data-day="mer"></td>
             <td contenteditable="true" data-cat="taxiBus" data-day="gio"></td>
             <td contenteditable="true" data-cat="taxiBus" data-day="ven"></td>
             <td contenteditable="true" data-cat="taxiBus" data-day="sab"></td>
             <td contenteditable="true" data-cat="taxiBus" data-day="dom"></td>
             <td class="totale-riga">0</td>
           </tr>
           <tr>
             <td>Biglietti Aerei/Treni</td>
             <td contenteditable="true" data-cat="biglietti" data-day="lun"></td>
             <td contenteditable="true" data-cat="biglietti" data-day="mar"></td>
             <td contenteditable="true" data-cat="biglietti" data-day="mer"></td>
             <td contenteditable="true" data-cat="biglietti" data-day="gio"></td>
             <td contenteditable="true" data-cat="biglietti" data-day="ven"></td>
             <td contenteditable="true" data-cat="biglietti" data-day="sab"></td>
             <td contenteditable="true" data-cat="biglietti" data-day="dom"></td>
             <td class="totale-riga">0</td>
           </tr>
           <tr>
             <td>Carburante c/contante</td>
             <td contenteditable="true" data-cat="carburCont" data-day="lun"></td>
             <td contenteditable="true" data-cat="carburCont" data-day="mar"></td>
             <td contenteditable="true" data-cat="carburCont" data-day="mer"></td>
             <td contenteditable="true" data-cat="carburCont" data-day="gio"></td>
             <td contenteditable="true" data-cat="carburCont" data-day="ven"></td>
             <td contenteditable="true" data-cat="carburCont" data-day="sab"></td>
             <td contenteditable="true" data-cat="carburCont" data-day="dom"></td>
             <td class="totale-riga">0</td>
           </tr>
           <tr>
             <td>Altro (Spese Viaggio)</td>
             <td contenteditable="true" data-cat="viaggioAltro" data-day="lun"></td>
             <td contenteditable="true" data-cat="viaggioAltro" data-day="mar"></td>
             <td contenteditable="true" data-cat="viaggioAltro" data-day="mer"></td>
             <td contenteditable="true" data-cat="viaggioAltro" data-day="gio"></td>
             <td contenteditable="true" data-cat="viaggioAltro" data-day="ven"></td>
             <td contenteditable="true" data-cat="viaggioAltro" data-day="sab"></td>
             <td contenteditable="true" data-cat="viaggioAltro" data-day="dom"></td>
             <td class="totale-riga">0</td>
           </tr>
 
           <!-- Subtotale giornaliero Spese Viaggio -->
           <tr class="sp-viaggio-subtot">
             <td class="totale-blocco">Subtotale giornaliero Spese Viaggio</td>
             <td data-cat="spViaggioDay" data-day="lun"></td>
             <td data-cat="spViaggioDay" data-day="mar"></td>
             <td data-cat="spViaggioDay" data-day="mer"></td>
             <td data-cat="spViaggioDay" data-day="gio"></td>
             <td data-cat="spViaggioDay" data-day="ven"></td>
             <td data-cat="spViaggioDay" data-day="sab"></td>
             <td data-cat="spViaggioDay" data-day="dom"></td>
             <td class="totale-blocco">0</td>
           </tr>
 
           <!-- Totale Spese Viaggio Settimana (con classe "totale-riga") -->
           <tr class="totale-riga">
             <td><strong>Totale Spese Viaggio Settimana</strong></td>
             <td colspan="7"></td>
             <td class="sp-viaggio-week-tot">0</td>
           </tr>
 
           <!-- ALLOGGIO E PASTI -->
           <tr>
             <td>Alloggio</td>
             <td contenteditable="true" data-cat="alloggio" data-day="lun"></td>
             <td contenteditable="true" data-cat="alloggio" data-day="mar"></td>
             <td contenteditable="true" data-cat="alloggio" data-day="mer"></td>
             <td contenteditable="true" data-cat="alloggio" data-day="gio"></td>
             <td contenteditable="true" data-cat="alloggio" data-day="ven"></td>
             <td contenteditable="true" data-cat="alloggio" data-day="sab"></td>
             <td contenteditable="true" data-cat="alloggio" data-day="dom"></td>
             <td class="totale-riga">0</td>
           </tr>
           <tr>
             <td>Colazione</td>
             <td contenteditable="true" data-cat="colazione" data-day="lun"></td>
             <td contenteditable="true" data-cat="colazione" data-day="mar"></td>
             <td contenteditable="true" data-cat="colazione" data-day="mer"></td>
             <td contenteditable="true" data-cat="colazione" data-day="gio"></td>
             <td contenteditable="true" data-cat="colazione" data-day="ven"></td>
             <td contenteditable="true" data-cat="colazione" data-day="sab"></td>
             <td contenteditable="true" data-cat="colazione" data-day="dom"></td>
             <td class="totale-riga">0</td>
           </tr>
           <tr>
             <td>Pranzo</td>
             <td contenteditable="true" data-cat="pranzo" data-day="lun"></td>
             <td contenteditable="true" data-cat="pranzo" data-day="mar"></td>
             <td contenteditable="true" data-cat="pranzo" data-day="mer"></td>
             <td contenteditable="true" data-cat="pranzo" data-day="gio"></td>
             <td contenteditable="true" data-cat="pranzo" data-day="ven"></td>
             <td contenteditable="true" data-cat="pranzo" data-day="sab"></td>
             <td contenteditable="true" data-cat="pranzo" data-day="dom"></td>
             <td class="totale-riga">0</td>
           </tr>
           <tr>
             <td>Cena</td>
             <td contenteditable="true" data-cat="cena" data-day="lun"></td>
             <td contenteditable="true" data-cat="cena" data-day="mar"></td>
             <td contenteditable="true" data-cat="cena" data-day="mer"></td>
             <td contenteditable="true" data-cat="cena" data-day="gio"></td>
             <td contenteditable="true" data-cat="cena" data-day="ven"></td>
             <td contenteditable="true" data-cat="cena" data-day="sab"></td>
             <td contenteditable="true" data-cat="cena" data-day="dom"></td>
             <td class="totale-riga">0</td>
           </tr>
           <tr>
             <td>Acqua/Caffè</td>
             <td contenteditable="true" data-cat="acquaCaffe" data-day="lun"></td>
             <td contenteditable="true" data-cat="acquaCaffe" data-day="mar"></td>
             <td contenteditable="true" data-cat="acquaCaffe" data-day="mer"></td>
             <td contenteditable="true" data-cat="acquaCaffe" data-day="gio"></td>
             <td contenteditable="true" data-cat="acquaCaffe" data-day="ven"></td>
             <td contenteditable="true" data-cat="acquaCaffe" data-day="sab"></td>
             <td contenteditable="true" data-cat="acquaCaffe" data-day="dom"></td>
             <td class="totale-riga">0</td>
           </tr>
           <tr>
             <td>Altro (Alloggio/Pasti)</td>
             <td contenteditable="true" data-cat="alloggioAltro" data-day="lun"></td>
             <td contenteditable="true" data-cat="alloggioAltro" data-day="mar"></td>
             <td contenteditable="true" data-cat="alloggioAltro" data-day="mer"></td>
             <td contenteditable="true" data-cat="alloggioAltro" data-day="gio"></td>
             <td contenteditable="true" data-cat="alloggioAltro" data-day="ven"></td>
             <td contenteditable="true" data-cat="alloggioAltro" data-day="sab"></td>
             <td contenteditable="true" data-cat="alloggioAltro" data-day="dom"></td>
             <td class="totale-riga">0</td>
           </tr>
 
           <!-- Subtotale giornaliero Alloggio/Pasti -->
           <tr class="alloggio-pasti-subtot">
             <td class="totale-blocco">Subtotale giornaliero Alloggio/Pasti</td>
             <td data-cat="alloggioDay" data-day="lun"></td>
             <td data-cat="alloggioDay" data-day="mar"></td>
             <td data-cat="alloggioDay" data-day="mer"></td>
             <td data-cat="alloggioDay" data-day="gio"></td>
             <td data-cat="alloggioDay" data-day="ven"></td>
             <td data-cat="alloggioDay" data-day="sab"></td>
             <td data-cat="alloggioDay" data-day="dom"></td>
             <td class="totale-blocco">0</td>
           </tr>
 
           <!-- Totale Alloggio/Pasti Settimana (con classe "totale-riga") -->
           <tr class="totale-riga">
             <td><strong>Totale Alloggio/Pasti Settimana</strong></td>
             <td colspan="7"></td>
             <td class="alloggio-week-tot">0</td>
           </tr>
 
           <!-- CARBURANTE (Carta ENI) -->
           <tr>
             <td>Carburante (Carta ENI)</td>
             <td contenteditable="true" data-cat="cartaEni" data-day="lun"></td>
             <td contenteditable="true" data-cat="cartaEni" data-day="mar"></td>
             <td contenteditable="true" data-cat="cartaEni" data-day="mer"></td>
             <td contenteditable="true" data-cat="cartaEni" data-day="gio"></td>
             <td contenteditable="true" data-cat="cartaEni" data-day="ven"></td>
             <td contenteditable="true" data-cat="cartaEni" data-day="sab"></td>
             <td contenteditable="true" data-cat="cartaEni" data-day="dom"></td>
             <td class="totale-riga">0</td>
           </tr>
           <tr class="carburante-subtot">
             <td class="totale-blocco">Subtotale giornaliero Carburante ENI</td>
             <td data-cat="carbEniDay" data-day="lun"></td>
             <td data-cat="carbEniDay" data-day="mar"></td>
             <td data-cat="carbEniDay" data-day="mer"></td>
             <td data-cat="carbEniDay" data-day="gio"></td>
             <td data-cat="carbEniDay" data-day="ven"></td>
             <td data-cat="carbEniDay" data-day="sab"></td>
             <td data-cat="carbEniDay" data-day="dom"></td>
             <td class="totale-blocco">0</td>
           </tr>
 
           <!-- Totale Carburante ENI Settimana (con classe "totale-riga") -->
           <tr class="totale-riga">
             <td><strong>Totale Carburante ENI Settimana</strong></td>
             <td colspan="7"></td>
             <td class="carburante-week-tot">0</td>
           </tr>
         </tbody>
         <tfoot>
           <!-- TOTALE SETTIMANA (anche qui classe "totale-riga") -->
           <tr class="totale-riga">
             <td><strong>TOTALE SETTIMANA</strong></td>
             <td colspan="7"></td>
             <td class="totale-settimana">0</td>
           </tr>
         </tfoot>
       </table>
     </div>
   </section>
 
   <!-- NOTE E FIRME -->
   <section>
     <div class="riga-dati">
       <label for="note">Note:</label>
       <textarea id="note" rows="3" style="flex:1;"></textarea>
     </div>
     <div class="riga-dati">
       <label for="firma-direzione">Visto Direzione:</label>
       <input type="text" id="firma-direzione" placeholder="Firma Direzione" />
       <label for="firma-dipendente">Firma Dipendente:</label>
       <input type="text" id="firma-dipendente" placeholder="Firma Dipendente" />
     </div>
   </section>
 
   <!-- PULSANTI -->
   <section id="esporta-stampa">
     <button id="stampa-txt">Stampa in TXT</button>
     <button id="condividi-whatsapp">Invia via WhatsApp</button>
     <button id="stampa-replica">Stampa Replica Form</button>
   </section>
 
 <!-- SEZIONE FOTO/IMMAGINI -->
 <section id="upload-sezione">
   <h2>Allegati Spese (Scontrini / Foto)</h2>
 
   <div class="riga-dati">
     <label for="settimana-immagini">Settimana (es. 11/2025):</label>
     <input type="text" id="settimana-immagini" placeholder="es. 11/2025" />
   </div>
 
   <div class="riga-dati">
     <input type="file" id="file-input" accept="image/*" multiple capture="environment"/>
     <button id="zip-btn">Crea ZIP e Condividi</button>
     <input type="file" id="file-input" accept="image/*" style="display:none" />
     <button id="foto-btn" type="button">📷 Scatta o Carica Foto</button>
     <button id="zip-btn" type="button">Crea ZIP e Condividi</button>
   </div>
 
   <div id="preview-immagini" style="display:flex; flex-wrap:wrap; gap:10px; margin-top:10px;"></div>
 </section>
 
 <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
 
   <!-- Script principale -->
   <script src="app.js"></script>
 
   <!-- Registrazione service worker (PWA) -->
   <script>
     if ('serviceWorker' in navigator) {
       navigator.serviceWorker.register('service-worker.js');
     }
   </script>
 </body>
 </html>
